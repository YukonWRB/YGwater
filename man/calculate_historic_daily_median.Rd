% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SWE_maputils.R
\name{calculate_historic_daily_median}
\alias{calculate_historic_daily_median}
\title{Calculate historic daily median and relative change for timeseries}
\usage{
calculate_historic_daily_median(
  ts,
  lookback_length = NULL,
  lookback_start = NULL,
  lookback_end = NULL
)
}
\arguments{
\item{ts}{Wide-format data.frame with 'datetime' column and station columns}

\item{lookback_length}{Integer number of years to look back from each measurement (optional)}

\item{lookback_start}{Integer year to start lookback period from (e.g., 1980) (optional)}

\item{lookback_end}{Integer year to end lookback period (optional, defaults to current year - 1)}
}
\value{
A list with two elements:
\describe{
\item{historic_median}{data.frame with historic median values for each date/station}
\item{relative_to_med}{data.frame with current values as percentage of historic median}
}
}
\description{
For each measurement, calculates the historic median for the same day-of-year
using data from previous years within the lookback period. Supports both
fixed lookback periods and rolling windows.
}
\details{
The function handles special cases for relative SWE calculation:
\itemize{
\item Standard percentage when historic median > 0
\item Value of -2 when both current and historic are zero
\item Value of -1 when current > 0 but historic is zero
}

Data is filtered to February-May and snapped to the 1st of each month for
consistency with snow bulletin reporting periods.
}
\examples{
\dontrun{
# Calculate using fixed lookback year
result <- calculate_historic_daily_median(ts_data, lookback_start = 1980)

# Calculate using rolling 30-year window
result <- calculate_historic_daily_median(ts_data, lookback_length = 30)
}
}
